"use strict";(self.webpackChunktypescript_eslint_chinese=self.webpackChunktypescript_eslint_chinese||[]).push([[657],{3905:function(e,t,n){n.d(t,{Zo:function(){return c},kt:function(){return g}});var o=n(7294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,o,i=function(e,t){if(null==e)return{};var n,o,i={},r=Object.keys(e);for(o=0;o<r.length;o++)n=r[o],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(o=0;o<r.length;o++)n=r[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var l=o.createContext({}),p=function(e){var t=o.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):a(a({},t),e)),n},c=function(e){var t=p(e.components);return o.createElement(l.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},d=o.forwardRef((function(e,t){var n=e.components,i=e.mdxType,r=e.originalType,l=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),d=p(n),g=i,f=d["".concat(l,".").concat(g)]||d[g]||u[g]||r;return n?o.createElement(f,a(a({ref:t},c),{},{components:n})):o.createElement(f,a({ref:t},c))}));function g(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var r=n.length,a=new Array(r);a[0]=d;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:i,a[1]=s;for(var p=2;p<r;p++)a[p]=n[p];return o.createElement.apply(null,a)}return o.createElement.apply(null,n)}d.displayName="MDXCreateElement"},5210:function(e,t,n){n.r(t),n.d(t,{assets:function(){return c},contentTitle:function(){return l},default:function(){return g},frontMatter:function(){return s},metadata:function(){return p},toc:function(){return u}});var o=n(3117),i=n(102),r=(n(7294),n(3905)),a=["components"],s={id:"monorepo",title:"Monorepo \u914d\u7f6e",sidebar_label:"Monorepo Configuration"},l=void 0,p={unversionedId:"linting/monorepo",id:"linting/monorepo",title:"Monorepo \u914d\u7f6e",description:"\u5982\u679c\u4f60\u4f7f\u7528 monorepo\uff0c\u8fd9\u7bc7\u6587\u7ae0\u5c06\u5e2e\u52a9\u4f60\u7406\u89e3\u5982\u4f55\u8bbe\u7f6e\u7c7b\u578b\u5316\u7684\u68c0\u6d4b\u3002",source:"@site/docs/linting/MONOREPO.md",sourceDirName:"linting",slug:"/linting/monorepo",permalink:"/typescript-eslint-chinese/docs/linting/monorepo",draft:!1,tags:[],version:"current",lastUpdatedBy:"GEARLESS JOE",lastUpdatedAt:1657247748,formattedLastUpdatedAt:"2022\u5e747\u67088\u65e5",frontMatter:{id:"monorepo",title:"Monorepo \u914d\u7f6e",sidebar_label:"Monorepo Configuration"},sidebar:"docs",previous:{title:"Configurations",permalink:"/typescript-eslint-chinese/docs/linting/configs"},next:{title:"Troubleshooting & FAQs",permalink:"/typescript-eslint-chinese/docs/linting/troubleshooting"}},c={},u=[{value:"\u5728 <code>tsconfig.json</code> \u6bcf\u4e00\u4e2a\u5b50\u9879\u76ee\u4e2d (\u5728\u6839\u76ee\u5f55\u8fd8\u6709\u4e00\u4e2a\u53ef\u9009\u7684)",id:"\u5728-tsconfigjson-\u6bcf\u4e00\u4e2a\u5b50\u9879\u76ee\u4e2d-\u5728\u6839\u76ee\u5f55\u8fd8\u6709\u4e00\u4e2a\u53ef\u9009\u7684",level:2},{value:"Important note regarding large (&gt; 10) multi-package monorepos",id:"important-note-regarding-large--10-multi-package-monorepos",level:3},{value:"One root <code>tsconfig.json</code>",id:"one-root-tsconfigjson",level:2},{value:"Troubleshooting",id:"troubleshooting",level:2}],d={toc:u};function g(e){var t=e.components,n=(0,i.Z)(e,a);return(0,r.kt)("wrapper",(0,o.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"\u5982\u679c\u4f60\u4f7f\u7528 monorepo\uff0c\u8fd9\u7bc7\u6587\u7ae0\u5c06\u5e2e\u52a9\u4f60\u7406\u89e3\u5982\u4f55\u8bbe\u7f6e\u7c7b\u578b\u5316\u7684\u68c0\u6d4b\u3002\n\u5982\u679c\u4f60\u4e0d\u60f3\u4f7f\u7528\u7c7b\u578b\u5316\u68c0\u6d4b\uff0c\u90a3\u4e48\u4f60\u53ef\u4ee5\u505c\u6b62\u9605\u8bfb - \u4f60\u4e0d\u9700\u8981\u505a\u4efb\u4f55\u7279\u6b8a\u7684\u4e8b\u60c5\u3002"),(0,r.kt)("p",null,"\u9996\u5148\u8981\u56de\u7b54\u7684\u95ee\u9898\u662f\u4f60\u7684 ",(0,r.kt)("inlineCode",{parentName:"p"},"tsconfig.json")," \u5982\u4f55\u8bbe\u7f6e\uff1f\u4f60\u5e94\u8be5\u4ece\u4e0b\u9762\u4e24\u4e2a\u4e2d\u9009\u4e00\u4e2a\u8bbe\u7f6e\uff1a"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("inlineCode",{parentName:"li"},"tsconfig.json")," \u5728\u6bcf\u4e00\u4e2a\u9879\u76ee\u4e2d (\u5728\u6839\u76ee\u5f55\u8fd8\u6709\u4e00\u4e2a\u53ef\u9009\u7684)"),(0,r.kt)("li",{parentName:"ol"},"\u6839\u76ee\u5f55\u7684 ",(0,r.kt)("inlineCode",{parentName:"li"},"tsconfig.json"))),(0,r.kt)("h2",{id:"\u5728-tsconfigjson-\u6bcf\u4e00\u4e2a\u5b50\u9879\u76ee\u4e2d-\u5728\u6839\u76ee\u5f55\u8fd8\u6709\u4e00\u4e2a\u53ef\u9009\u7684"},"\u5728 ",(0,r.kt)("inlineCode",{parentName:"h2"},"tsconfig.json")," \u6bcf\u4e00\u4e2a\u5b50\u9879\u76ee\u4e2d (\u5728\u6839\u76ee\u5f55\u8fd8\u6709\u4e00\u4e2a\u53ef\u9009\u7684)"),(0,r.kt)("p",null,"\u5728\u6211\u4eec\u4e4b\u524d\u7684 ",(0,r.kt)("a",{parentName:"p",href:"/typescript-eslint-chinese/docs/linting/type-linting"},"\u5e26\u7c7b\u578b\u4fe1\u606f\u7684\u68c0\u6d4b"),"\u6587\u7ae0\u4e2d, \u6211\u4eec\u7ed9\u4f60\u5c55\u793a\u4e86\u5982\u4f55\u4f7f\u7528 ",(0,r.kt)("inlineCode",{parentName:"p"},"parserOptions.project"),"\u9009\u9879(\u53c2\u6570) \u6765\u8bbe\u7f6e\u7c7b\u578b\u5316\u7684\u68c0\u6d4b\u5728\u914d\u7f6e\u4e2d\u3002\u8fd9\u4e2a\u9009\u9879\u63a5\u6536\u4e00\u4e2a\u76f8\u5bf9\u8def\u5f84\u7684\u6570\u7ec4\uff0c\u5141\u8bb8\u4f60\u6307\u5b9a\u6bcf\u4e00\u4e2a",(0,r.kt)("inlineCode",{parentName:"p"},"tsconfig.json"),"\u5728\u4f60\u7684 monorepo \u4e2d\u4f7f\u7528\u3002 \u5bf9\u4e8e\u62e5\u6709\u592a\u591a\u9879\u76ee\u5305\u7684\u4eba, \u4f60\u8fd8\u53ef\u4ee5\u63d0\u4f9b\u4e00\u4e2a",(0,r.kt)("a",{parentName:"p",href:"https://github.com/isaacs/node-glob/blob/f5a57d3d6e19b324522a3fa5bdd5075fd1aa79d1/README.md#glob-primer"},"glob path"),"."),(0,r.kt)("p",null,"\u4f8b\u5982, this is how we specify all of our ",(0,r.kt)("inlineCode",{parentName:"p"},"tsconfig.json")," within this repo."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js",metastring:'title=".eslintrc.js"',title:'".eslintrc.js"'},'module.exports = {\n  root: true,\n  parser: "@typescript-eslint/parser",\n  parserOptions: {\n    tsconfigRootDir: __dirname,\n    // Remove this line\n    project: ["./tsconfig.json"],\n    // Add this line\n    project: ["./tsconfig.eslint.json", "./packages/*/tsconfig.json"],\n  },\n  plugins: ["@typescript-eslint"],\n  extends: [\n    "eslint:recommended",\n    "plugin:@typescript-eslint/recommended",\n    "plugin:@typescript-eslint/recommended-requiring-type-checking",\n  ],\n};\n')),(0,r.kt)("p",null,"If you're looking for an example of what the ",(0,r.kt)("inlineCode",{parentName:"p"},".eslintrc.js"),", and referenced ",(0,r.kt)("inlineCode",{parentName:"p"},"tsconfig.json")," might look like in a real example, look no further than this very repo. We're a multi-package monorepo that uses one ",(0,r.kt)("inlineCode",{parentName:"p"},"tsconfig.json")," per package, that also uses typed linting."),(0,r.kt)("h3",{id:"important-note-regarding-large--10-multi-package-monorepos"},"Important note regarding large (> 10) multi-package monorepos"),(0,r.kt)("p",null,"We've had reports that for sufficiently large and/or interdependent projects, you may run into OOMs using this approach. Our advice is to set it up and test first, as there are very few cases that trigger this OOM. We are in the process of investigating solutions with the help of the TypeScript team."),(0,r.kt)("p",null,"See ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/typescript-eslint/typescript-eslint/issues/1192"},"#1192")," for more information and discussion."),(0,r.kt)("p",null,"If you do run into an OOM, please comment on the above issue and let us know about your repo - the more information we have, the better. As an interim workaround, consider one of the following:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Switching to one root ",(0,r.kt)("inlineCode",{parentName:"li"},"tsconfig.eslint.json")," (see below)"),(0,r.kt)("li",{parentName:"ul"},"Using a shell script to only lint one package at a time, using your existing config above.")),(0,r.kt)("h2",{id:"one-root-tsconfigjson"},"One root ",(0,r.kt)("inlineCode",{parentName:"h2"},"tsconfig.json")),(0,r.kt)("p",null,"If you've only got one, you should inspect the ",(0,r.kt)("inlineCode",{parentName:"p"},"include")," paths. If it doesn't include all of your files, then we won't be able to lint them. In this instance, you have two options: add them in to the ",(0,r.kt)("inlineCode",{parentName:"p"},"include"),", or create a new config."),(0,r.kt)("p",null,"The former doesn't always work for everyone if they've got a complex build, as adding more paths (like test paths) to ",(0,r.kt)("inlineCode",{parentName:"p"},"include")," could break the build.\nIn those cases we suggest creating a new config called ",(0,r.kt)("inlineCode",{parentName:"p"},"tsconfig.eslint.json"),", that looks something like this:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-jsonc",metastring:'title="tsconfig.eslint.json"',title:'"tsconfig.eslint.json"'},'{\n  // extend your base config to share compilerOptions, etc\n  "extends": "./tsconfig.json",\n  "compilerOptions": {\n    // ensure that nobody can accidentally use this config for a build\n    "noEmit": true\n  },\n  "include": [\n    // whatever paths you intend to lint\n    "src",\n    "test",\n    "tools"\n  ]\n}\n')),(0,r.kt)("p",null,"Ensure you update your ",(0,r.kt)("inlineCode",{parentName:"p"},".eslintrc.js")," to point at this new config file."),(0,r.kt)("h2",{id:"troubleshooting"},"Troubleshooting"),(0,r.kt)("p",null,"If you're having problems getting this working, please have a look at our ",(0,r.kt)("a",{parentName:"p",href:"/typescript-eslint-chinese/docs/linting/troubleshooting"},"Troubleshooting FAQ"),"."))}g.isMDXComponent=!0}}]);